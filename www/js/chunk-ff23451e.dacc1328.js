(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ff23451e"],{"188a":function(e,s,t){},1959:function(e,s,t){"use strict";t.d(s,"h",function(){return o}),t.d(s,"d",function(){return i}),t.d(s,"c",function(){return c}),t.d(s,"g",function(){return u}),t.d(s,"f",function(){return l}),t.d(s,"j",function(){return f}),t.d(s,"b",function(){return b}),t.d(s,"i",function(){return w}),t.d(s,"a",function(){return v}),t.d(s,"e",function(){return C});t("c5f6"),t("96cf");var r=t("3b8d"),n=t("9f30"),a=t("6ace");function o(e){return 2===e}function i(e,s){var t=e.txSerialize().length;return t+=110*s,1e5*Math.ceil(t/1024)}function c(e,s){var t=e.txSerialize().length;return t+=110*s,1e6*Math.ceil(t/1024)}function u(e,s,t){return d.apply(this,arguments)}function d(){return d=Object(r["a"])(regeneratorRuntime.mark(function e(s,t,r){var n,o,i,c,u,d,p,f;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=Number(Object(a["b"])(s.amount,s.fee)),o=0,i=t.nonce,c=s.amount,u=0,6===r&&2===r){e.next=8;break}if(!(t.balance<n)){e.next=8;break}return e.abrupt("return",{success:!1,data:"Your balance is not enough."});case 8:if(4===r?u=-1:5===r?u=-1:6===r?(n=s.amount,o=-1,i=s.depositHash.substring(s.depositHash.length-16),c=s.amount-s.fee):9===r&&(n=s.amount,o=-1,i=s.depositHash.substring(s.depositHash.length-16),c=s.amount-s.fee,u=(new Date).valueOf()+2592e5),d=[{address:s.fromAddress,assetsChainId:s.assetsChainId,assetsId:s.assetsId,amount:n,locked:o,nonce:i}],2!==r||s.assetsChainId===Object(a["f"])()){e.next=19;break}return d[0].amount=s.amount,e.next=14,l(Object(a["f"])(),s.assetsId,s.fromAddress);case 14:if(p=e.sent,!(p.data.balance<1e5)){e.next=18;break}return console.log("余额小于手续费"),e.abrupt("return");case 18:d.push({address:s.fromAddress,assetsChainId:Object(a["f"])(),assetsId:s.assetsId,amount:1e5,locked:o,nonce:p.data.nonce});case 19:if(f=[],15!==r&&17!==r){e.next=22;break}return e.abrupt("return",{success:!0,data:{inputs:d,outputs:f}});case 22:if(16!==r){e.next=28;break}if(s.toAddress){e.next=27;break}return e.abrupt("return",{success:!0,data:{inputs:d,outputs:f}});case 27:c=s.value;case 28:return f=[{address:s.toAddress?s.toAddress:s.fromAddress,assetsChainId:s.assetsChainId,assetsId:s.assetsId,amount:c,lockTime:u}],e.abrupt("return",{success:!0,data:{inputs:d,outputs:f}});case 30:case"end":return e.stop()}},e)})),d.apply(this,arguments)}function l(){return p.apply(this,arguments)}function p(){return p=Object(r["a"])(regeneratorRuntime.mark(function e(){var s,t,r,a=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s=a.length>0&&void 0!==a[0]?a[0]:2,t=a.length>1&&void 0!==a[1]?a[1]:1,r=a.length>2?a[2]:void 0,e.next=5,Object(n["a"])("/","getAccountBalance",[s,t,r]).then(function(e){return e.hasOwnProperty("result")?{success:!0,data:{balance:e.result.balance,nonce:e.result.nonce}}:{success:!1,data:e}}).catch(function(e){return{success:!1,data:e}});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})),p.apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return m=Object(r["a"])(regeneratorRuntime.mark(function e(s){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(n["a"])("/","validateTx",[s]).then(function(e){return e.hasOwnProperty("result")?{success:!0,data:e.result}:{success:!1,data:e.error}}).catch(function(e){return{success:!1,data:e}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),m.apply(this,arguments)}function b(e){return h.apply(this,arguments)}function h(){return h=Object(r["a"])(regeneratorRuntime.mark(function e(s){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(n["a"])("/","broadcastTx",[s]).then(function(e){return e.hasOwnProperty("result")?{success:!0,data:e.result}:{success:!1,data:e.error}}).catch(function(e){return{success:!1,data:e}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),h.apply(this,arguments)}function w(e){return g.apply(this,arguments)}function g(){return g=Object(r["a"])(regeneratorRuntime.mark(function e(s){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(n["a"])("/","validateTx",[s]).then(function(e){if(e.hasOwnProperty("result")){var t=e.result.value;return Object(n["a"])("/","broadcastTx",[s]).then(function(e){return e.hasOwnProperty("result")?{success:!0,hash:t}:{success:!1,data:e.error}}).catch(function(e){return{success:!1,data:e}})}return{success:!1,data:e.error}}).catch(function(e){return{success:!1,data:e}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),g.apply(this,arguments)}function v(e){return $.apply(this,arguments)}function $(){return $=Object(r["a"])(regeneratorRuntime.mark(function e(s){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(n["a"])("/","getConsensusDeposit",[1,300,s]).then(function(e){return e.result}).catch(function(e){return{success:!1,data:e}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),$.apply(this,arguments)}function C(e){return k.apply(this,arguments)}function k(){return k=Object(r["a"])(regeneratorRuntime.mark(function e(s){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(n["a"])("/","getContractConstructor",[s]).then(function(e){return e.hasOwnProperty("result")?{success:!0,data:e.result.constructor}:{success:!1,data:e.error}}).catch(function(e){return{success:!1,data:e}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),k.apply(this,arguments)}},2736:function(e,s,t){"use strict";t.r(s);var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"new_consensus bg-gray"},[t("div",{staticClass:"bg-white"},[t("div",{staticClass:"w1200"},[t("BackBar",{attrs:{backTitle:e.$t("nav.consensus")}}),t("h3",{staticClass:"title"},[e._v(e._s(e.$t("newConsensus.newConsensus0")))])],1)]),t("div",{staticClass:"w1200 bg-white mt_20"},[t("el-form",{ref:"createrForm",attrs:{model:e.createrForm,rules:e.createrRules}},[t("el-form-item",{attrs:{label:e.$t("public.createAddress")}},[t("el-input",{attrs:{disabled:""},model:{value:e.addressInfo.address,callback:function(s){e.$set(e.addressInfo,"address","string"===typeof s?s.trim():s)},expression:"addressInfo.address"}})],1),t("el-form-item",{attrs:{label:e.$t("public.rewardAddress"),prop:"rewardAddress"}},[t("el-input",{attrs:{maxlength:"50"},model:{value:e.createrForm.rewardAddress,callback:function(s){e.$set(e.createrForm,"rewardAddress","string"===typeof s?s.trim():s)},expression:"createrForm.rewardAddress"}})],1),t("el-form-item",{attrs:{label:e.$t("public.packingAddress"),prop:"blockAddress"}},[t("el-input",{attrs:{maxlength:"50"},model:{value:e.createrForm.blockAddress,callback:function(s){e.$set(e.createrForm,"blockAddress","string"===typeof s?s.trim():s)},expression:"createrForm.blockAddress"}})],1),t("el-form-item",{attrs:{label:e.$t("public.deposit")+"("+e.agentAsset.agentAsset.symbol+")",prop:"amount"}},[t("span",{staticClass:"balance font12 fr"},[e._v(e._s(e.$t("consensus.consensus2"))+": "+e._s(e.balanceInfo.balance/1e8))]),t("el-input",{model:{value:e.createrForm.amount,callback:function(s){e.$set(e.createrForm,"amount","string"===typeof s?s.trim():s)},expression:"createrForm.amount"}})],1),t("el-form-item",{attrs:{label:e.$t("public.commission")+"(%)",prop:"rate"}},[t("el-input",{model:{value:e.createrForm.rate,callback:function(s){e.$set(e.createrForm,"rate","string"===typeof s?s.trim():s)},expression:"createrForm.rate"}})],1),t("div",{staticClass:"font14"},[t("el-tooltip",{attrs:{placement:"top"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.$t("transfer.transfer5")))]),t("i",{staticClass:"el-icon-warning"})]),e._v("\n        "+e._s(e.$t("public.fee"))+": 0.001 "),t("span",{staticClass:"fCN"},[e._v(e._s(e.agentAsset.agentAsset.symbol))])],1),t("el-form-item",{staticClass:"form-next"},[t("el-button",{attrs:{type:"success",disabled:e.isRed},on:{click:function(s){return e.submitForm("createrForm")}}},[e._v(e._s(e.$t("password.password3"))+"\n        ")])],1)],1)],1),t("Password",{ref:"password",on:{passwordSubmit:e.passSubmit}}),t("el-dialog",{staticClass:"confirm-dialog",attrs:{title:e.$t("newConsensus.newConsensus1"),visible:e.newConsensusVisible,width:"40rem"},on:{"update:visible":function(s){e.newConsensusVisible=s}}},[t("div",{staticClass:"bg-white"},[t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.createAddress"))+": ")]),t("label",[e._v(e._s(e.addressInfo.address))])]),t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.rewardAddress"))+": ")]),t("label",[e._v(e._s(e.createrForm.rewardAddress))])]),t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.packingAddress"))+": ")]),t("label",[e._v(e._s(e.createrForm.blockAddress))])]),t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.commission"))+": ")]),t("label",{staticClass:"yellow"},[e._v(e._s(e.createrForm.rate)+"% ")])]),t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.deposit"))+": ")]),t("label",{staticClass:"yellow"},[e._v(e._s(e.createrForm.amount)+" "),t("span",{staticClass:"fCN"},[e._v(e._s(e.agentAsset.agentAsset.symbol))])])]),t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.fee"))+": ")]),t("label",[e._v("0.001 "),t("span",{staticClass:"fCN"},[e._v(e._s(e.agentAsset.agentAsset.symbol))])])])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(s){e.newConsensusVisible=!1}}},[e._v(e._s(e.$t("password.password2")))]),t("el-button",{attrs:{type:"success"},on:{click:e.confiremSubmit}},[e._v(e._s(e.$t("transfer.transfer8")))])],1)])],1)},n=[],a=(t("6b54"),t("c5f6"),t("96cf"),t("3b8d")),o=t("0ad0"),i=t.n(o),c=t("1959"),u=t("6ace"),d=t("d1f0"),l=t("b301"),p={data:function(){var e=this,s=function(s,t,r){var n=/^(?![a-zA-Z]+$)(?![^\da-zA-Z]+$).{20,50}$/;return t?n.exec(t)?(e.$refs.createrForm.validateField("blockAddress"),void r()):r(new Error(e.$t("newConsensus.newConsensus21"))):r(new Error(e.$t("newConsensus.newConsensus2")))},t=function(s,t,r){var n=/^(?![a-zA-Z]+$)(?![^\da-zA-Z]+$).{20,50}$/;return t?t===e.addressInfo.address?r(new Error(e.$t("newConsensus.newConsensus4"))):n.exec(t)?void r():r(new Error(e.$t("newConsensus.newConsensus31"))):r(new Error(e.$t("newConsensus.newConsensus3")))},r=function(s,t,r){var n=/^\d+(?=\.{0,1}\d+$|$)/,a=/^\d{1,8}(\.\d{1,8})?$/,o=e.balanceInfo.balance-1e8*t;if(!t)return r(new Error(e.$t("newConsensus.newConsensus5")));n.exec(t)&&a.exec(t)?o<.001?r(new Error(e.$t("newConsensus.newConsensus7"))):t<2e4||t>5e5?r(new Error(e.$t("newConsensus.newConsensus8"))):r():r(new Error(e.$t("newConsensus.newConsensus6")))},n=function(s,t,r){var n=/^([1]?\d{1,2})$/;if(!t)return r(new Error(e.$t("newConsensus.newConsensus9")));n.exec(t)?t<10||t>100?r(new Error(e.$t("newConsensus.newConsensus11"))):r():r(new Error(e.$t("newConsensus.newConsensus10")))};return{addressInfo:{},balanceInfo:{},agentAsset:JSON.parse(sessionStorage.getItem("info")),isRed:!1,createrForm:{rewardAddress:"",blockAddress:"",amount:"",rate:""},createrRules:{rewardAddress:[{validator:s,trigger:["blur","change"]}],blockAddress:[{validator:t,trigger:["blur","change"]}],amount:[{validator:r,trigger:["blur","change"]}],rate:[{validator:n,trigger:["blur","change"]}]},newConsensusVisible:!1}},created:function(){var e=this;this.addressInfo=Object(u["e"])(1),setInterval(function(){e.addressInfo=Object(u["e"])(1)},500)},mounted:function(){this.getPunishByAddress(this.addressInfo.address),this.getBalanceByAddress(this.agentAsset.agentAsset.chainId,this.agentAsset.agentAsset.assetId,this.addressInfo.address)},watch:{addressInfo:function(e,s){e&&e.address!==s.address&&s.address&&(this.getPunishByAddress(this.addressInfo.address),this.getBalanceByAddress(this.agentAsset.agentAsset.chainId,this.agentAsset.agentAsset.assetId,this.addressInfo.address))}},components:{Password:d["a"],BackBar:l["a"]},methods:{submitForm:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(s){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$refs[s].validate(function(e){if(!e)return!1;t.newConsensusVisible=!0});case 1:case"end":return e.stop()}},e,this)}));function s(s){return e.apply(this,arguments)}return s}(),getBalanceByAddress:function(e,s,t){var r=this;Object(c["f"])(e,s,t).then(function(e){e.success?r.balanceInfo=e.data:r.$message({message:r.$t("public.err2")+e,type:"error",duration:1e3})}).catch(function(e){r.$message({message:r.$t("public.err3")+e,type:"error",duration:1e3})})},getPunishByAddress:function(e){var s=this;this.$post("/","getPunishList",[1,10,2,e]).then(function(e){0!==e.result.list.length?(s.isRed=!0,s.$message({message:s.$t("newConsensus.newConsensus12"),type:"error",duration:3e3})):s.isRed=!1}).catch(function(e){s.$message({message:s.$t("public.err3")+e,type:"error",duration:1e3})})},confiremSubmit:function(){this.$refs.password.showPassword(!0)},passSubmit:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(s){var t,r,n,a,o,d,l,p=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={fromAddress:this.addressInfo.address,assetsChainId:this.agentAsset.agentAsset.chainId,assetsId:this.agentAsset.agentAsset.assetId,amount:Number(Object(u["d"])(this.createrForm.amount,1e8).toString()),fee:1e5},e.next=3,Object(c["g"])(t,this.balanceInfo,4);case 3:if(r=e.sent,n="",!r.success){e.next=23;break}return a={agentAddress:this.addressInfo.address,packingAddress:this.createrForm.blockAddress,rewardAddress:this.createrForm.rewardAddress,commissionRate:Number(this.createrForm.rate),deposit:Number(Object(u["d"])(this.createrForm.amount,1e8).toString())},e.next=9,i.a.transactionAssemble(r.data.inputs,r.data.outputs,"",4,a);case 9:if(o=e.sent,d=i.a.decrypteOfAES(this.addressInfo.aesPri,s),l=i.a.importByKey(this.addressInfo.chainId,d,s),l.address!==this.addressInfo.address){e.next=20;break}return e.next=15,i.a.transactionSerialize(d,this.addressInfo.pub,o);case 15:return n=e.sent,e.next=18,Object(c["i"])(n).then(function(e){e.success?p.$router.push({name:"txList"}):p.$message({message:p.$t("error."+e.data.code),type:"error",duration:3e3})}).catch(function(e){p.$message({message:p.$t("public.err0")+e,type:"error",duration:1e3})});case 18:e.next=21;break;case 20:this.$message({message:this.$t("address.address13"),type:"error",duration:1e3});case 21:e.next=24;break;case 23:this.$message({message:this.$t("public.err1")+r.data,type:"error",duration:1e3});case 24:case"end":return e.stop()}},e,this)}));function s(s){return e.apply(this,arguments)}return s}()}},f=p,m=(t("b83f"),t("2877")),b=Object(m["a"])(f,r,n,!1,null,null,null);s["default"]=b.exports},"2e64":function(e,s,t){"use strict";var r=t("ff03"),n=t.n(r);n.a},7672:function(e,s,t){"use strict";var r=t("188a"),n=t.n(r);n.a},a464:function(e,s,t){},b301:function(e,s,t){"use strict";var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"back",attrs:{backUrl:e.backUrl}},[t("span",{staticClass:"back-box",on:{click:e.back}},[t("i",{staticClass:"el-icon-arrow-left"}),t("span",[e._v(e._s(e.backTitle))])])])},n=[],a={props:{backTitle:{type:String,default:""},backUrl:{type:String,default:"1"},backParams:{type:String,default:""}},methods:{back:function(){"1"===this.backUrl?this.$router.go(-1):this.$router.push({name:this.backUrl})}}},o=a,i=(t("2e64"),t("2877")),c=Object(i["a"])(o,r,n,!1,null,null,null);s["a"]=c.exports},b83f:function(e,s,t){"use strict";var r=t("a464"),n=t.n(r);n.a},d1f0:function(e,s,t){"use strict";var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("el-dialog",{staticClass:"password-dialog",attrs:{title:e.$t("password.password1"),visible:e.passwordVisible,top:"30vh",width:"30rem","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(s){e.passwordVisible=s},open:e.passwordShow,close:e.passwordClose}},[t("el-form",{ref:"passwordForm",attrs:{model:e.passwordForm,rules:e.passwordRules},nativeOn:{submit:function(e){e.preventDefault()}}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(e.$t("password.password1")))]),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{ref:"inpus",attrs:{type:"password",maxlength:22},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.enterSubmit("passwordForm")}},model:{value:e.passwordForm.password,callback:function(s){e.$set(e.passwordForm,"password",s)},expression:"passwordForm.password"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.passwordClose}},[e._v(e._s(e.$t("password.password2")))]),t("el-button",{attrs:{type:"success",id:"passwordInfo"},on:{click:function(s){return e.dialogSubmit("passwordForm")}}},[e._v(e._s(e.$t("password.password3"))+"\n    ")])],1)],1)},n=[],a={props:{},data:function(){var e=this,s=function(s,t,r){""===t?r(new Error(e.$t("password.password1"))):r()};return{passwordVisible:!1,passwordForm:{password:""},passwordRules:{password:[{validator:s,trigger:["blur","change"]}]}}},created:function(){},mounted:function(){},watch:{passwordVisible:function(e){var s=this;e&&setTimeout(function(){s.$refs["inpus"].focus()},200)}},methods:{enterSubmit:function(e){this.passwordForm.password&&this.dialogSubmit(e)},passwordShow:function(){},passwordClose:function(){this.$refs["passwordForm"].resetFields(),this.passwordVisible=!1},showPassword:function(e){this.passwordVisible=e},dialogSubmit:function(e){var s=this;this.$refs[e].validate(function(e){if(!e)return!1;s.$emit("passwordSubmit",s.passwordForm.password),s.passwordVisible=!1})}}},o=a,i=(t("7672"),t("2877")),c=Object(i["a"])(o,r,n,!1,null,null,null);s["a"]=c.exports},ff03:function(e,s,t){}}]);
//# sourceMappingURL=chunk-ff23451e.dacc1328.js.map